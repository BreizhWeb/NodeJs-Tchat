<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Client CHAT</title>
    <link href="./style.css" rel="stylesheet">
</head>
<body>
    <div id="container">
        <div id="register">
            <h2>Chat IO</h2>
            <p>Register :</p>
            <div id="error"></div>
            <form id="registerForm" method="POST" action="./register">
                <input type="text" size="35" id="username" name="username">
                <input type="password" size="35" id="password" name="password">
                <input type="submit" value="Register">
            </form>
            <p>Login : </p>
            <form id="loginForm" method="POST" action="./login">
                <input type="text" size="35" id="username" name="username">
                <input type="password" size="35" id="password" name="password">
                <input type="submit" value="Login">
            </form>
        </div>

        <div id="mainWrapper">
            <h2>ChatIO</h2>
            <div id="chatWrapper">
                <div id="chatWindow"></div>
                <form id="messageForm">
                    <input type="text" size="35" id="message" placeholder="Say something...">
                    <input type="submit" value="Submit">
                </form>
            </div>
        </div>

        <div id="userWrapper">
            <div id="users"></div>
        </div>
    </div>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>
    <script>
        $(function (){
            var socket =io.connect();
            var $messageForm = $("#messageForm");
            var $message = $("#message");
            var $chat = $("#chatWindow");

            //round 2
            var $registerForm = $("#registerForm");
            var $users = $("#users");
            var $username = $("#username");
            var $password = $("#password");
            var $error = $("#error");


            /*$messageForm.submit(function(e){
                e.preventDefault();
                console.log("Submittted..");
                socket.emit("send message",$message.val());
                $message.val("");
            });*/

            //round 2 add the username
            socket.on("new message",function(data){
                $chat.append("<strong>" + data.user + "</strong>: " + data.msg + "<br/>");
            });

            //round 2
            /*$registerForm.submit(function(e){
                e.preventDefault();
                socket.emit("registration",[$username.val(),$password.val()],function(data){
                    if(data){
                        $("#namesWrapper").hide();
                        $("#mainWrapper").show();
                        $("#userWrapper").show();
                    }else{
                        $error.html("Username is taken");
                    }
                });
                //$username.val("");
            });*/

            socket.on("usernames",function(data){
                let html = "";
                for (i=0;i<data.length;i++){
                    html += data[i] + "<br>";
                }
                $users.html(html);
            });

        });
    </script>
</body>
</html>